

Download
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toply - Recruitment Intelligence Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .container { width: 100%; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 24px; margin-bottom: 20px; }
        .stat-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 20px; border-radius: 12px; margin: 10px; min-width: 200px; cursor: pointer; transition: transform 0.2s; }
        .stat-card:hover { transform: translateY(-2px); }
        .stat-card.hot { background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%); }
        .stat-card.active { background: linear-gradient(135deg, #00d2d3 0%, #54a0ff 100%); }
        .stat-card.top { background: linear-gradient(135deg, #a55eea 0%, #26de81 100%); }
        .nav-item { padding: 12px 24px; cursor: pointer; border-radius: 8px; margin: 0 4px; transition: all 0.2s; }
        .nav-item:hover { background: #f1f3f4; }
        .nav-item.active { background: #4285f4; color: white; }
        .similarity-bar { height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden; margin: 8px 0; }
        .similarity-fill { height: 100%; transition: width 0.3s ease; }
        .similarity-high { background: linear-gradient(90deg, #4caf50, #8bc34a); }
        .similarity-medium { background: linear-gradient(90deg, #ff9800, #ffc107); }
        .similarity-low { background: linear-gradient(90deg, #f44336, #ff5722); }
        .match-badge { padding: 4px 8px; border-radius: 12px; font-size: 12px; font-weight: bold; }
        .match-high { background: #e8f5e8; color: #2e7d32; }
        .match-medium { background: #fff3e0; color: #ef6c00; }
        .match-low { background: #ffebee; color: #c62828; }
        .user-selector { position: fixed; top: 20px; right: 20px; z-index: 1000; }
        .alert { padding: 12px; border-radius: 8px; margin: 10px 0; }
        .alert-warning { background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; }
        .alert-success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .alert-info { background: #cce7ff; border: 1px solid #74c0fc; color: #055160; }
        .sidebar { position: fixed; right: -400px; top: 0; width: 400px; height: 100vh; background: white; box-shadow: -2px 0 10px rgba(0,0,0,0.1); transition: right 0.3s ease; z-index: 1001; overflow-y: auto; }
        .sidebar.open { right: 0; }
        .sidebar-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.5); z-index: 1000; display: none; }
        .sidebar-overlay.active { display: block; }
        .floating-btn { position: fixed; bottom: 20px; right: 20px; background: #4285f4; color: white; border: none; border-radius: 50%; width: 60px; height: 60px; font-size: 18px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 999; }
        .boolean-query { background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 16px; font-family: monospace; font-size: 14px; margin: 10px 0; }
        .pattern-card { background: #f8f9fa; border-radius: 8px; padding: 16px; margin: 10px 0; border-left: 4px solid #4285f4; }
        .progress-ring { transform: rotate(-90deg); }
        .progress-ring-circle { transition: stroke-dasharray 0.35s; transform: rotate(-90deg); transform-origin: 50% 50%; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #f8f9fa; font-weight: 600; }
        .btn { padding: 8px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: all 0.2s; }
        .btn-primary { background: #4285f4; color: white; }
        .btn-success { background: #34a853; color: white; }
        .btn-warning { background: #fbbc04; color: #333; }
        .btn-danger { background: #ea4335; color: white; }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }
        .upload-area { border: 2px dashed #ccc; border-radius: 8px; padding: 40px; text-align: center; cursor: pointer; transition: all 0.2s; }
        .upload-area:hover { border-color: #4285f4; background: #f8f9ff; }
        .tag { display: inline-block; padding: 4px 8px; background: #e3f2fd; color: #1976d2; border-radius: 12px; font-size: 12px; margin: 2px; }
        .tag.looking { background: #e8f5e8; color: #2e7d32; }
        .tag.urgent { background: #ffebee; color: #c62828; }
        .tag.hot { background: #fff3e0; color: #ef6c00; }
        .hidden { display: none; }
        .dropdown { position: relative; display: inline-block; }
        .dropdown-content { display: none; position: absolute; background-color: white; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1; border-radius: 8px; }
        .dropdown:hover .dropdown-content { display: block; }
        .notification { position: fixed; top: 80px; right: 20px; background: #4caf50; color: white; padding: 12px 20px; border-radius: 8px; z-index: 1002; transform: translateX(100%); transition: transform 0.3s ease; }
        .notification.show { transform: translateX(0); }
        .tabs { border-bottom: 2px solid #e0e0e0; margin-bottom: 20px; }
        .tab-button { background: none; border: none; padding: 12px 24px; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.2s; }
        .tab-button.active { border-bottom-color: #4285f4; color: #4285f4; font-weight: 600; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .search-filters { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .filter-row { display: flex; gap: 15px; margin-bottom: 15px; align-items: center; flex-wrap: wrap; }
        .filter-group { display: flex; flex-direction: column; min-width: 200px; }
        .filter-group label { font-weight: 500; margin-bottom: 5px; color: #333; }
        .filter-group input, .filter-group select { padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .checkbox-group { display: flex; gap: 20px; align-items: center; flex-wrap: wrap; }
        .checkbox-item { display: flex; align-items: center; gap: 5px; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- User Selector -->
    <div class="user-selector">
        <select id="userSelect" class="bg-white border border-gray-300 rounded-lg px-4 py-2 shadow-sm">
            <option value="">👤 Continue as Guest</option>
            <option value="Dana">Dana</option>
            <option value="Alexey">Alexey</option>
            <option value="Katinka">Katinka</option>
            <option value="Shiri">Shiri</option>
            <option value="Mika">Mika</option>
            <option value="Chen">Chen</option>
            <option value="Andrea">Andrea</option>
            <option value="Eszter">Eszter</option>
            <option value="Danana">Danana</option>
        </select>
        <div id="selectedCount" class="mt-2 text-center">
            <button id="selectedBtn" class="bg-blue-500 text-white px-4 py-2 rounded-lg shadow" onclick="toggleSidebar()">
                <i class="fas fa-list"></i> Selected (0)
            </button>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="bg-blue-600 text-white rounded-lg p-2">
                        <i class="fas fa-brain text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">Toply Intelligence Hub</h1>
                        <p class="text-gray-600 text-sm">Advanced Recruitment Intelligence Platform</p>
                    </div>
                </div>
                <div id="userStatus" class="text-sm text-gray-600">
                    <i class="fas fa-user-circle"></i> <span id="currentUser">Guest Mode</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white border-b">
        <div class="container mx-auto px-6">
            <div class="flex space-x-1">
                <button class="nav-item active" onclick="showTab('dashboard')">
                    <i class="fas fa-tachometer-alt mr-2"></i>Hot Signals Dashboard
                </button>
                <button class="nav-item" onclick="showTab('search')">
                    <i class="fas fa-search mr-2"></i>Smart Search
                </button>
                <button class="nav-item" onclick="showTab('similarity')">
                    <i class="fas fa-brain mr-2"></i>AI Matching
                </button>
                <button class="nav-item" onclick="showTab('sourcing')">
                    <i class="fas fa-robot mr-2"></i>Auto-Sourcing
                </button>
                <button class="nav-item" onclick="showTab('companies')">
                    <i class="fas fa-building mr-2"></i>Companies
                </button>
                <button class="nav-item" onclick="showTab('analytics')">
                    <i class="fas fa-chart-line mr-2"></i>Analytics
                </button>
                <button class="nav-item" onclick="showTab('settings')">
                    <i class="fas fa-cog mr-2"></i>Settings
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-6">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="stat-card hot" onclick="showHotCompanies()">
                    <div class="text-3xl font-bold">28</div>
                    <div class="text-sm opacity-90">Hot Companies</div>
                    <div class="text-xs mt-2">Recent market events detected</div>
                </div>
                <div class="stat-card active" onclick="showActiveCandidates()">
                    <div class="text-3xl font-bold">100+</div>
                    <div class="text-sm opacity-90">Active Candidates</div>
                    <div class="text-xs mt-2">Ready for immediate contact</div>
                </div>
                <div class="stat-card top" onclick="showTopProfiles()">
                    <div class="text-3xl font-bold" id="topProfilesCount">0</div>
                    <div class="text-sm opacity-90">TOP Profiles</div>
                    <div class="text-xs mt-2">Upload Scorely results</div>
                </div>
                <div class="stat-card" onclick="showGoodProfiles()">
                    <div class="text-3xl font-bold" id="goodProfilesCount">0</div>
                    <div class="text-sm opacity-90">GOOD Profiles</div>
                    <div class="text-xs mt-2">From Scorely analysis</div>
                </div>
            </div>

            <!-- Priority Recommendations -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4 flex items-center">
                    <i class="fas fa-fire text-red-500 mr-2"></i>
                    Today's Priority Recommendations
                </h3>
                <div class="space-y-4">
                    <div class="alert alert-warning">
                        <strong>Contact candidates from Microsoft immediately</strong><br>
                        3 active candidates + recent layoffs = 85% response rate expected
                    </div>
                    <div class="alert alert-info">
                        <strong>Unity talent surge detected</strong><br>
                        3 candidates from Unity - consider Gaming/Mobile opportunities
                    </div>
                    <div class="alert alert-success">
                        <strong>Security sector opportunity</strong><br>
                        Review 12 new Security professionals this week
                    </div>
                </div>
            </div>

            <!-- Market Intelligence -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4 flex items-center">
                    <i class="fas fa-chart-line text-blue-500 mr-2"></i>
                    Market Intelligence
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold mb-3">This Week's Intelligence</h4>
                        <ul class="space-y-2 text-sm">
                            <li><span class="text-blue-600">•</span> Security sector: 23% more active candidates</li>
                            <li><span class="text-green-600">•</span> Backend roles: High demand detected</li>
                            <li><span class="text-orange-600">•</span> Microsoft candidates: 85% response rate</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-3">Best Timing Recommendations</h4>
                        <ul class="space-y-2 text-sm">
                            <li><span class="text-red-600">•</span> Wiz candidates: Contact now (layoffs detected)</li>
                            <li><span class="text-blue-600">•</span> Microsoft window: Next 2 weeks optimal</li>
                            <li><span class="text-purple-600">•</span> Q1 hiring surge: Prepare candidate pipeline</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Similarity Search Tab -->
        <div id="similarity" class="tab-content">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fas fa-brain text-purple-500 mr-3"></i>
                    AI Similarity Search
                </h2>
                
                <!-- Upload Scorely Results -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Upload Scorely Results</h3>
                    <div class="upload-area" onclick="document.getElementById('scorelyFile').click()">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                        <p class="text-lg font-medium">Drag & drop Scorely JSON file here</p>
                        <p class="text-sm text-gray-600 mt-2">or click to browse</p>
                        <p class="text-xs text-gray-500 mt-1">Supports: .json, .csv files with embeddings</p>
                    </div>
                    <input type="file" id="scorelyFile" class="hidden" accept=".json,.csv" onchange="handleScorelyUpload(event)">
                </div>

                <!-- Find Similar Candidates -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Find Similar Candidates</h3>
                    <textarea id="similarityQuery" class="w-full h-32 p-4 border border-gray-300 rounded-lg" 
                              placeholder="Enter job description, candidate profile, or requirements...&#10;&#10;Example:&#10;- 'Senior Backend Engineer with Python, AWS, 5+ years'&#10;- 'Looking for profiles similar to our best developer'&#10;- 'Find candidates from companies like Wiz'"></textarea>
                    <button class="btn btn-primary mt-4" onclick="findSimilarCandidates()">
                        <i class="fas fa-search mr-2"></i>Find Similar Candidates
                    </button>
                </div>

                <!-- Similarity Results -->
                <div id="similarityResults" class="hidden">
                    <h3 class="text-lg font-semibold mb-4">Similarity Results</h3>
                    <div class="overflow-x-auto">
                        <table id="similarityTable">
                            <thead>
                                <tr>
                                    <th>Select</th>
                                    <th>Candidate</th>
                                    <th>Overall Match</th>
                                    <th>Skills</th>
                                    <th>Company</th>
                                    <th>Title</th>
                                    <th>Experience</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="similarityTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Auto-Sourcing Tab -->
        <div id="sourcing" class="tab-content">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fas fa-robot text-green-500 mr-3"></i>
                    Auto-Sourcing Intelligence
                </h2>

                <!-- Success Patterns Analysis -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="pattern-card">
                        <h3 class="font-semibold mb-4">Success Patterns Analysis</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <h4 class="text-sm font-medium text-gray-600 mb-2">Top Companies</h4>
                                <div class="space-y-1">
                                    <div class="flex justify-between text-sm">
                                        <span>Wiz</span><span class="text-blue-600">3 TOP</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span>Cybereason</span><span class="text-blue-600">2 TOP</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span>Astrix</span><span class="text-blue-600">2 TOP</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-600 mb-2">Top Skills</h4>
                                <div class="space-y-1">
                                    <div class="flex justify-between text-sm">
                                        <span>Python</span><span class="text-green-600">85%</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span>AWS</span><span class="text-green-600">78%</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span>Kubernetes</span><span class="text-green-600">71%</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-600 mb-2">Top Titles</h4>
                                <div class="space-y-1">
                                    <div class="flex justify-between text-sm">
                                        <span>Backend Engineer</span><span class="text-purple-600">65%</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span>Senior Developer</span><span class="text-purple-600">58%</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span>Tech Lead</span><span class="text-purple-600">42%</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-600 mb-2">Experience</h4>
                                <div class="space-y-1">
                                    <div class="flex justify-between text-sm">
                                        <span>4-6 years</span><span class="text-orange-600">68%</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span>7-10 years</span><span class="text-orange-600">25%</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span>3-4 years</span><span class="text-orange-600">15%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="pattern-card">
                        <h3 class="font-semibold mb-4">Generated Boolean Queries</h3>
                        <div class="space-y-4">
                            <div>
                                <h4 class="text-sm font-medium text-gray-600 mb-2">LinkedIn Boolean Query</h4>
                                <div class="boolean-query">
                                    ("Backend Engineer" OR "Senior Developer") ("Python" OR "AWS" OR "Kubernetes") ("Wiz" OR "Cybereason" OR "Astrix")
                                </div>
                                <div class="flex gap-2 mt-2">
                                    <button class="btn btn-primary" onclick="copyToClipboard('linkedin-boolean')">
                                        <i class="fas fa-copy mr-1"></i>Copy
                                    </button>
                                    <button class="btn btn-primary" onclick="openLinkedInSearch()">
                                        <i class="fab fa-linkedin mr-1"></i>Open in LinkedIn
                                    </button>
                                </div>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-600 mb-2">Google Boolean Query</h4>
                                <div class="boolean-query">
                                    ("Backend Engineer" OR "Senior Developer") Python AWS site:linkedin.com
                                </div>
                                <div class="flex gap-2 mt-2">
                                    <button class="btn btn-primary" onclick="copyToClipboard('google-boolean')">
                                        <i class="fas fa-copy mr-1"></i>Copy
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Smart Sourcing Suggestions -->
                <div class="card bg-blue-50 border border-blue-200">
                    <h3 class="font-semibold mb-4 text-blue-800">Smart Sourcing Suggestions</h3>
                    <div class="space-y-3">
                        <div class="flex items-start space-x-3">
                            <i class="fas fa-bullseye text-blue-600 mt-1"></i>
                            <div>
                                <strong>Try targeting Backend Engineers at Check Point</strong>
                                <p class="text-sm text-gray-600">Similar security company profile to your successful Wiz hires</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <i class="fas fa-search text-green-600 mt-1"></i>
                            <div>
                                <strong>Look for Python developers with 5+ years experience</strong>
                                <p class="text-sm text-gray-600">82% success rate in your previous TOP-rated candidates</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <i class="fas fa-users text-purple-600 mt-1"></i>
                            <div>
                                <strong>Consider DevOps from Security companies</strong>
                                <p class="text-sm text-gray-600">80% skill overlap with your successful Backend Engineer hires</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Smart Search Tab -->
        <div id="search" class="tab-content">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fas fa-search text-blue-500 mr-3"></i>
                    Smart Candidate Search
                </h2>

                <!-- Search Filters -->
                <div class="search-filters">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label>Job Title / Role</label>
                            <input type="text" id="jobTitle" placeholder="e.g. Backend Engineer, Senior Developer">
                        </div>
                        <div class="filter-group">
                            <label>Skills</label>
                            <input type="text" id="skills" placeholder='Use "," for AND, "OR" for either'>
                        </div>
                        <div class="filter-group">
                            <label>Experience Level</label>
                            <select id="experience">
                                <option value="">Any Experience</option>
                                <option value="1-3">1-3 years</option>
                                <option value="3-5">3-5 years</option>
                                <option value="5-7">5-7 years</option>
                                <option value="7+">7+ years</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Location</label>
                            <input type="text" id="location" placeholder="e.g. Tel Aviv, Remote">
                        </div>
                    </div>
                    <div class="filter-row">
                        <div class="filter-group">
                            <label>Company Filter</label>
                            <input type="text" id="companyFilter" placeholder="e.g. Microsoft, Wiz, Security">
                        </div>
                        <div class="filter-group">
                            <label>Score Range</label>
                            <select id="scoreRange">
                                <option value="">Any Score</option>
                                <option value="80-100">80-100 (TOP)</option>
                                <option value="60-79">60-79 (GOOD)</option>
                                <option value="40-59">40-59 (MEDIUM)</option>
                            </select>
                        </div>
                    </div>
                    <div class="filter-row">
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="lookingOnly">
                                <label for="lookingOnly">Show only LOOKING candidates</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="hotCompaniesOnly">
                                <label for="hotCompaniesOnly">Show only from Hot Companies</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="unviewedOnly">
                                <label for="unviewedOnly">Show only unviewed (this week)</label>
                            </div>
                        </div>
                    </div>
                    <div class="filter-row">
                        <button class="btn btn-primary" onclick="searchCandidates()">
                            <i class="fas fa-search mr-2"></i>Search Candidates
                        </button>
                        <button class="btn btn-warning" onclick="clearFilters()">
                            <i class="fas fa-times mr-2"></i>Clear Filters
                        </button>
                        <button class="btn btn-success" onclick="resetViewedStatus()">
                            <i class="fas fa-eye mr-2"></i>Reset Viewed Status
                        </button>
                    </div>
                </div>

                <!-- Search Results -->
                <div id="searchResults">
                    <div class="overflow-x-auto">
                        <table id="candidatesTable">
                            <thead>
                                <tr>
                                    <th>Select</th>
                                    <th>Candidate</th>
                                    <th>Status</th>
                                    <th>Company</th>
                                    <th>Title</th>
                                    <th>Experience</th>
                                    <th>Score</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="candidatesTableBody">
                                <!-- Sample data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Companies Tab -->
        <div id="companies" class="tab-content">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fas fa-building text-orange-500 mr-3"></i>
                    Companies Intelligence
                </h2>

                <!-- Company Filters -->
                <div class="search-filters">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label>Industry</label>
                            <select id="industryFilter">
                                <option value="">All Industries</option>
                                <option value="Cybersecurity">Cybersecurity</option>
                                <option value="Fintech">Fintech</option>
                                <option value="AI">AI/ML</option>
                                <option value="Gaming">Gaming</option>
                                <option value="SaaS">SaaS</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Company Size</label>
                            <select id="sizeFilter">
                                <option value="">Any Size</option>
                                <option value="startup">Startup (1-50)</option>
                                <option value="small">Small (51-200)</option>
                                <option value="medium">Medium (201-1000)</option>
                                <option value="large">Large (1000+)</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Status</label>
                            <select id="statusFilter">
                                <option value="">All Status</option>
                                <option value="hot">Hot Companies</option>
                                <option value="unicorn">Unicorns</option>
                                <option value="public">Public</option>
                                <option value="series">Series A-D</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Hot Companies This Week -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-fire text-red-500 mr-2"></i>
                        Hot Companies This Week
                    </h3>
                    <p class="text-sm text-gray-600 mb-4">Companies with recent activity - higher candidate response rates expected</p>
                    <div id="hotCompaniesList" class="space-y-3">
                        <!-- Hot companies will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fas fa-chart-line text-purple-500 mr-3"></i>
                    Analytics
                </h2>
                <p class="text-gray-600">Advanced analytics and insights coming soon...</p>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fas fa-cog text-gray-500 mr-3"></i>
                    Settings & Integrations
                </h2>

                <!-- Secure Setup Instructions -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
                    <h3 class="text-lg font-semibold text-blue-800 mb-4 flex items-center">
                        <i class="fas fa-shield-alt mr-2"></i>
                        Secure Setup Instructions
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-medium text-blue-700 mb-2">For Netlify Deployment:</h4>
                            <ol class="text-sm text-blue-600 space-y-1 list-decimal list-inside">
                                <li>Go to your Netlify site dashboard</li>
                                <li>Navigate to Site Settings → Environment Variables</li>
                                <li>Add these variables:</li>
                                <ul class="ml-4 mt-1 space-y-1">
                                    <li>• GOOGLE_API_KEY → Your Google Sheets API key</li>
                                    <li>• OPENAI_API_KEY → Your OpenAI API key</li>
                                </ul>
                                <li>Deploy your site - keys will be automatically loaded</li>
                            </ol>
                        </div>
                        <div>
                            <h4 class="font-medium text-blue-700 mb-2">Security Benefits:</h4>
                            <ul class="text-sm text-blue-600 space-y-1">
                                <li>🔒 API keys never exposed in code</li>
                                <li>🔐 Safe for public GitHub repositories</li>
                                <li>👥 Team access without sharing keys</li>
                                <li>📝 Easy key rotation and management</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Google Sheets Integration -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Google Sheets Integration</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Google Sheets API Key</label>
                            <div class="flex space-x-2">
                                <input type="password" id="googleApiKey" class="flex-1 px-3 py-2 border border-gray-300 rounded-md" placeholder="Enter your Google Sheets API key">
                                <button id="testGoogleConnection" class="btn btn-success" onclick="testGoogleConnection()">
                                    <i class="fas fa-check mr-1"></i>Test Connection
                                </button>
                            </div>
                            <div id="googleConnectionStatus" class="mt-2"></div>
                        </div>
                    </div>
                </div>

                <!-- OpenAI Integration -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">OpenAI Integration</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">OpenAI API Key</label>
                            <div class="flex space-x-2">
                                <input type="password" id="openaiApiKey" class="flex-1 px-3 py-2 border border-gray-300 rounded-md" placeholder="Enter your OpenAI API key">
                                <button id="testOpenAIConnection" class="btn btn-success" onclick="testOpenAIConnection()">
                                    <i class="fas fa-check mr-1"></i>Test Connection
                                </button>
                            </div>
                            <div id="openaiConnectionStatus" class="mt-2"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Model Selection</label>
                            <select id="openaiModel" class="w-full px-3 py-2 border border-gray-300 rounded-md">
                                <option value="text-embedding-3-small">text-embedding-3-small (Recommended)</option>
                                <option value="text-embedding-3-large">text-embedding-3-large</option>
                                <option value="text-embedding-ada-002">text-embedding-ada-002</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Data Sources -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Data Sources</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <h4 class="font-medium text-green-800 mb-2">Active Candidates</h4>
                            <p class="text-sm text-green-600 mb-2">100+ candidates actively looking for opportunities</p>
                            <span class="inline-block px-2 py-1 bg-green-100 text-green-800 text-xs rounded">Connected</span>
                        </div>
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <h4 class="font-medium text-red-800 mb-2">Hot Companies</h4>
                            <p class="text-sm text-red-600 mb-2">28 companies with recent market events</p>
                            <span class="inline-block px-2 py-1 bg-red-100 text-red-800 text-xs rounded">Connected</span>
                        </div>
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="font-medium text-blue-800 mb-2">Companies Database</h4>
                            <p class="text-sm text-blue-600 mb-2">396 companies with detailed intelligence</p>
                            <span class="inline-block px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded">Connected</span>
                        </div>
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                            <h4 class="font-medium text-yellow-800 mb-2">Scorely Results</h4>
                            <p class="text-sm text-yellow-600 mb-2">TOP and GOOD candidate profiles with embeddings</p>
                            <span class="inline-block px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded">Upload Required</span>
                        </div>
                    </div>
                </div>

                <!-- Advanced Settings -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Advanced Settings</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Similarity Threshold</label>
                            <input type="range" id="similarityThreshold" min="0" max="100" value="50" class="w-full">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>0%</span>
                                <span>Minimum similarity score to show results</span>
                                <span>100%</span>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" id="autoSaveSettings" class="mr-2">
                                <span class="text-sm">Auto-Save Settings</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="cacheEmbeddings" class="mr-2" checked>
                                <span class="text-sm">Cache Embeddings (Save API costs)</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Selected Candidates Sidebar -->
    <div id="sidebarOverlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>
    <div id="candidatesSidebar" class="sidebar">
        <div class="p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold">Selected Candidates</h3>
                <button onclick="toggleSidebar()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="selectedCandidatesContent">
                <div class="text-center text-gray-500 py-8">
                    <i class="fas fa-users text-4xl mb-4 opacity-50"></i>
                    <p>No candidates selected</p>
                </div>
            </div>
            <div class="mt-6 space-y-3">
                <button class="w-full btn btn-primary" onclick="exportSelectedCSV()">
                    <i class="fas fa-download mr-2"></i>Export CSV
                </button>
                <button class="w-full btn btn-primary" onclick="exportLinkedInURLs()">
                    <i class="fab fa-linkedin mr-2"></i>Export LinkedIn URLs
                </button>
                <button class="w-full btn btn-danger" onclick="clearSelectedCandidates()">
                    <i class="fas fa-trash mr-2"></i>Clear All
                </button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
        // Global variables
        let selectedCandidates = [];
        let currentUser = '';
        let viewedCandidates = {};
        let scorelyData = [];
        let hotCompaniesData = [];
        let companiesData = [];
        let activeCandidatesData = [];

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            loadViewedCandidates();
            setupUserSelector();
            loadInitialData();
        });

        // User Management
        function setupUserSelector() {
            const userSelect = document.getElementById('userSelect');
            userSelect.addEventListener('change', function() {
                currentUser = this.value;
                updateUserStatus();
                loadViewedCandidates();
            });
        }

        function updateUserStatus() {
            const userStatusElement = document.getElementById('currentUser');
            if (currentUser) {
                userStatusElement.innerHTML = `<i class="fas fa-user"></i> ${currentUser}`;
            } else {
                userStatusElement.innerHTML = `<i class="fas fa-user-circle"></i> Guest Mode`;
            }
        }

        // Tab Management
        function showTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from nav items
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked nav item
            event.target.classList.add('active');
        }

        // Dashboard Actions
        function showHotCompanies() {
            showTab('companies');
            // Auto-filter to show only hot companies
            document.getElementById('statusFilter').value = 'hot';
        }

        function showActiveCandidates() {
            showTab('search');
            // Auto-check the LOOKING filter
            document.getElementById('lookingOnly').checked = true;
            searchCandidates();
        }

        function showTopProfiles() {
            showTab('similarity');
        }

        function showGoodProfiles() {
            showTab('similarity');
        }

        // Data Loading
        function loadInitialData() {
            loadHotCompanies();
            loadActiveCandidates();
            loadCompanies();
            populateSampleData();
        }

        async function loadHotCompanies() {
            try {
                const apiKey = getGoogleApiKey();
                if (!apiKey) return;

                const sheetId = '1It9bHPbIRXX3Ezf_-phAZvyE3SYMbd1zt7PlkrLX-HU';
                const gid = '1275023562'; // Updated tab ID
                const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&gid=${gid}`;
                
                const response = await fetch(url);
                const text = await response.text();
                const jsonData = JSON.parse(text.substring(47).slice(0, -2));
                
                hotCompaniesData = parseGoogleSheetsData(jsonData);
                updateHotCompaniesList();
            } catch (error) {
                console.error('Error loading hot companies:', error);
            }
        }

        async function loadActiveCandidates() {
            try {
                const apiKey = getGoogleApiKey();
                if (!apiKey) return;

                const sheetId = '1QNQDB--R4yRhvI_fe7C2wn9g94WPDqZYRXsGJFrbJQA';
                const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;
                
                const response = await fetch(url);
                const text = await response.text();
                const jsonData = JSON.parse(text.substring(47).slice(0, -2));
                
                activeCandidatesData = parseActiveCandidatesData(jsonData);
                updateCandidatesTable();
            } catch (error) {
                console.error('Error loading active candidates:', error);
            }
        }

        async function loadCompanies() {
            try {
                const apiKey = getGoogleApiKey();
                if (!apiKey) return;

                const sheetId = '1It9bHPbIRXX3Ezf_-phAZvyE3SYMbd1zt7PlkrLX-HU';
                const gid = 'Companies'; // Companies tab
                const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${gid}`;
                
                const response = await fetch(url);
                const text = await response.text();
                const jsonData = JSON.parse(text.substring(47).slice(0, -2));
                
                companiesData = parseCompaniesData(jsonData);
            } catch (error) {
                console.error('Error loading companies:', error);
            }
        }

        // Data Parsing
        function parseGoogleSheetsData(jsonData) {
            const rows = jsonData.table.rows;
            const data = [];
            
            for (let i = 1; i < rows.length; i++) { // Skip header
                const row = rows[i];
                if (row.c && row.c[0] && row.c[0].v) {
                    data.push({
                        company: row.c[0]?.v || '',
                        eventType: row.c[1]?.v || '',
                        industry: row.c[2]?.v || '',
                        location: row.c[3]?.v || '',
                        source: row.c[4]?.v || '',
                        notes: row.c[5]?.v || '',
                        dateReported: row.c[6]?.v || '',
                        link: row.c[7]?.v || '',
                        summary: row.c[8]?.v || ''
                    });
                }
            }
            return data;
        }

        function parseActiveCandidatesData(jsonData) {
            const rows = jsonData.table.rows;
            const data = [];
            
            for (let i = 1; i < rows.length; i++) { // Skip header
                const row = rows[i];
                if (row.c && row.c[0] && row.c[0].v) {
                    data.push({
                        name: row.c[0]?.v || '',
                        linkedin: row.c[1]?.v || '',
                        company: row.c[2]?.v || '',
                        note: row.c[3]?.v || '',
                        status: 'LOOKING',
                        isActive: true
                    });
                }
            }
            return data;
        }

        function parseCompaniesData(jsonData) {
            const rows = jsonData.table.rows;
            const data = [];
            
            for (let i = 1; i < rows.length; i++) { // Skip header
                const row = rows[i];
                if (row.c && row.c[0] && row.c[0].v) {
                    data.push({
                        name: row.c[0]?.v || '',
                        location: row.c[1]?.v || '',
                        employeeCount: row.c[2]?.v || '',
                        technologies: row.c[3]?.v || '',
                        workEnvironment: row.c[4]?.v || '',
                        products: row.c[5]?.v || '',
                        industry: row.c[6]?.v || '',
                        status: row.c[7]?.v || '',
                        additionalInfo: row.c[8]?.v || ''
                    });
                }
            }
            return data;
        }

        function populateSampleData() {
            // Sample candidates for demo
            const sampleCandidates = [
                {
                    name: 'Dana M.',
                    company: 'Wiz',
                    title: 'Backend Engineer',
                    experience: '5 years',
                    score: 87,
                    status: 'LOOKING',
                    linkedin: '#',
                    skills: ['Python', 'AWS', 'Docker'],
                    isHotCompany: true
                },
                {
                    name: 'Yoav S.',
                    company: 'Unity',
                    title: 'Senior Developer',
                    experience: '6 years',
                    score: 84,
                    status: 'LOOKING',
                    linkedin: '#',
                    skills: ['C#', 'Unity', 'Game Dev'],
                    isHotCompany: true
                },
                {
                    name: 'Sarah L.',
                    company: 'Microsoft',
                    title: 'Principal Engineer',
                    experience: '8 years',
                    score: 91,
                    status: 'LOOKING',
                    linkedin: '#',
                    skills: ['C++', 'Azure', 'Leadership'],
                    isHotCompany: true
                }
            ];

            updateCandidatesTable(sampleCandidates);
        }

        // UI Updates
        function updateHotCompaniesList() {
            const container = document.getElementById('hotCompaniesList');
            if (!container || !hotCompaniesData.length) return;

            container.innerHTML = hotCompaniesData.map(company => `
                <div class="flex items-center justify-between p-4 bg-white border border-red-200 rounded-lg">
                    <div class="flex-1">
                        <div class="flex items-center space-x-3">
                            <span class="text-lg font-semibold">${company.company}</span>
                            <span class="tag hot">${company.eventType}</span>
                            <span class="text-sm text-gray-600">${company.industry}</span>
                        </div>
                        <p class="text-sm text-gray-600 mt-1">${company.notes || company.summary}</p>
                    </div>
                    <div class="flex space-x-2">
                        <button class="btn btn-primary" onclick="viewCompanyMatches('${company.company}')">
                            <i class="fas fa-eye mr-1"></i>View Matches
                        </button>
                        <button class="btn btn-warning" onclick="trackCompany('${company.company}')">
                            <i class="fas fa-bookmark mr-1"></i>Track
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateCandidatesTable(candidates = activeCandidatesData) {
            const tbody = document.getElementById('candidatesTableBody');
            if (!tbody) return;

            tbody.innerHTML = candidates.map((candidate, index) => {
                const isViewed = isViewedCandidate(candidate.name);
                const viewedClass = isViewed ? 'opacity-75' : '';
                const viewedIcon = isViewed ? '<i class="fas fa-eye text-gray-400 mr-1"></i>' : '<i class="fas fa-circle text-green-400 mr-1" style="font-size: 8px;"></i>';
                
                return `
                    <tr class="${viewedClass}">
                        <td>
                            <input type="checkbox" onchange="toggleCandidateSelection('${candidate.name}', this.checked)">
                        </td>
                        <td>
                            <div class="flex items-center">
                                ${viewedIcon}
                                <span class="font-medium">${candidate.name}</span>
                                ${candidate.status === 'LOOKING' ? '<span class="tag looking ml-2">LOOKING</span>' : ''}
                                ${candidate.isHotCompany ? '<span class="tag hot ml-2">HOT COMPANY</span>' : ''}
                            </div>
                        </td>
                        <td>
                            <span class="tag ${candidate.status === 'LOOKING' ? 'looking' : ''}">${candidate.status || 'Available'}</span>
                        </td>
                        <td>${candidate.company}</td>
                        <td>${candidate.title || 'N/A'}</td>
                        <td>${candidate.experience || 'N/A'}</td>
                        <td>
                            <div class="flex items-center">
                                <span class="font-medium">${candidate.score || 'N/A'}</span>
                                ${candidate.score ? `<div class="ml-2 w-12 h-2 bg-gray-200 rounded-full overflow-hidden">
                                    <div class="h-full bg-blue-500" style="width: ${candidate.score}%"></div>
                                </div>` : ''}
                            </div>
                        </td>
                        <td>
                            <div class="flex space-x-2">
                                <button class="btn btn-primary text-xs" onclick="viewCandidate('${candidate.name}')">
                                    <i class="fas fa-eye"></i>
                                </button>
                                ${candidate.linkedin ? `<a href="${candidate.linkedin}" target="_blank" class="btn btn-primary text-xs">
                                    <i class="fab fa-linkedin"></i>
                                </a>` : ''}
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Search functionality
        function searchCandidates() {
            const filters = {
                jobTitle: document.getElementById('jobTitle').value,
                skills: document.getElementById('skills').value,
                experience: document.getElementById('experience').value,
                location: document.getElementById('location').value,
                companyFilter: document.getElementById('companyFilter').value,
                scoreRange: document.getElementById('scoreRange').value,
                lookingOnly: document.getElementById('lookingOnly').checked,
                hotCompaniesOnly: document.getElementById('hotCompaniesOnly').checked,
                unviewedOnly: document.getElementById('unviewedOnly').checked
            };

            // Apply filters to data
            let filteredCandidates = activeCandidatesData.filter(candidate => {
                if (filters.lookingOnly && candidate.status !== 'LOOKING') return false;
                if (filters.hotCompaniesOnly && !candidate.isHotCompany) return false;
                if (filters.unviewedOnly && isViewedCandidate(candidate.name)) return false;
                if (filters.companyFilter && !candidate.company.toLowerCase().includes(filters.companyFilter.toLowerCase())) return false;
                
                return true;
            });

            updateCandidatesTable(filteredCandidates);
            showNotification(`Found ${filteredCandidates.length} candidates matching your criteria`);
        }

        function clearFilters() {
            document.getElementById('jobTitle').value = '';
            document.getElementById('skills').value = '';
            document.getElementById('experience').value = '';
            document.getElementById('location').value = '';
            document.getElementById('companyFilter').value = '';
            document.getElementById('scoreRange').value = '';
            document.getElementById('lookingOnly').checked = false;
            document.getElementById('hotCompaniesOnly').checked = false;
            document.getElementById('unviewedOnly').checked = false;
            
            updateCandidatesTable();
        }

        // Candidate Selection
        function toggleCandidateSelection(candidateName, selected) {
            if (selected) {
                if (!selectedCandidates.find(c => c.name === candidateName)) {
                    const candidate = activeCandidatesData.find(c => c.name === candidateName);
                    if (candidate) {
                        selectedCandidates.push(candidate);
                    }
                }
            } else {
                selectedCandidates = selectedCandidates.filter(c => c.name !== candidateName);
            }
            
            updateSelectedCount();
            updateSidebarContent();
        }

        function updateSelectedCount() {
            const count = selectedCandidates.length;
            document.getElementById('selectedBtn').innerHTML = `
                <i class="fas fa-list"></i> Selected (${count})
            `;
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('candidatesSidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function updateSidebarContent() {
            const container = document.getElementById('selectedCandidatesContent');
            
            if (selectedCandidates.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-users text-4xl mb-4 opacity-50"></i>
                        <p>No candidates selected</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                <div class="space-y-3">
                    ${selectedCandidates.map(candidate => `
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <div class="font-medium">${candidate.name}</div>
                                <div class="text-sm text-gray-600">${candidate.company} - ${candidate.title || 'N/A'}</div>
                            </div>
                            <button class="text-red-500 hover:text-red-700" onclick="removeFromSelection('${candidate.name}')">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function removeFromSelection(candidateName) {
            selectedCandidates = selectedCandidates.filter(c => c.name !== candidateName);
            updateSelectedCount();
            updateSidebarContent();
            
            // Update checkbox in table
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => {
                if (cb.onchange && cb.onchange.toString().includes(candidateName)) {
                    cb.checked = false;
                }
            });
        }

        function clearSelectedCandidates() {
            selectedCandidates = [];
            updateSelectedCount();
            updateSidebarContent();
            
            // Clear all checkboxes
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = false);
        }

        // Export Functions
        function exportSelectedCSV() {
            if (selectedCandidates.length === 0) {
                showNotification('No candidates selected for export', 'warning');
                return;
            }

            const csvContent = [
                ['Name', 'Company', 'Title', 'Experience', 'Status', 'LinkedIn'],
                ...selectedCandidates.map(c => [
                    c.name,
                    c.company,
                    c.title || '',
                    c.experience || '',
                    c.status || '',
                    c.linkedin || ''
                ])
            ].map(row => row.map(field => `"${field}"`).join(',')).join('\n');

            downloadCSV(csvContent, 'selected_candidates.csv');
            showNotification(`Exported ${selectedCandidates.length} candidates to CSV`);
        }

        function exportLinkedInURLs() {
            if (selectedCandidates.length === 0) {
                showNotification('No candidates selected for export', 'warning');
                return;
            }

            const urls = selectedCandidates
                .filter(c => c.linkedin)
                .map(c => c.linkedin)
                .join('\n');

            if (urls) {
                navigator.clipboard.writeText(urls).then(() => {
                    showNotification('LinkedIn URLs copied to clipboard');
                });
            } else {
                showNotification('No LinkedIn URLs found in selected candidates', 'warning');
            }
        }

        function downloadCSV(content, filename) {
            const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Viewed Candidates Management
        function isViewedCandidate(candidateName) {
            if (!currentUser) return false;
            return viewedCandidates[currentUser] && viewedCandidates[currentUser].includes(candidateName);
        }

        function markAsViewed(candidateName) {
            if (!currentUser) return;
            
            if (!viewedCandidates[currentUser]) {
                viewedCandidates[currentUser] = [];
            }
            
            if (!viewedCandidates[currentUser].includes(candidateName)) {
                viewedCandidates[currentUser].push(candidateName);
                saveViewedCandidates();
            }
        }

        function viewCandidate(candidateName) {
            markAsViewed(candidateName);
            updateCandidatesTable();
            // Here you would typically open a detailed view
            showNotification(`Viewed ${candidateName} - marked as seen`);
        }

        function resetViewedStatus() {
            if (currentUser) {
                viewedCandidates[currentUser] = [];
                saveViewedCandidates();
                updateCandidatesTable();
                showNotification('Viewed status reset for this week');
            }
        }

        function saveViewedCandidates() {
            localStorage.setItem('toply_viewed_candidates', JSON.stringify(viewedCandidates));
        }

        function loadViewedCandidates() {
            const saved = localStorage.getItem('toply_viewed_candidates');
            if (saved) {
                viewedCandidates = JSON.parse(saved);
            }
        }

        // Similarity Search
        function handleScorelyUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    if (file.name.endsWith('.json')) {
                        scorelyData = JSON.parse(content);
                    } else if (file.name.endsWith('.csv')) {
                        scorelyData = parseCSV(content);
                    }
                    
                    showNotification(`Loaded ${scorelyData.length} candidates from Scorely`);
                    updateProfileCounts();
                } catch (error) {
                    showNotification('Error parsing file: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
        }

        function findSimilarCandidates() {
            const query = document.getElementById('similarityQuery').value;
            if (!query.trim()) {
                showNotification('Please enter a search query', 'warning');
                return;
            }

            if (scorelyData.length === 0) {
                showNotification('Please upload Scorely results first', 'warning');
                return;
            }

            // Simulate similarity calculation
            const results = scorelyData.map(candidate => ({
                ...candidate,
                similarity: Math.random() * 100,
                skillsMatch: Math.random() * 100,
                companyMatch: Math.random() * 100,
                titleMatch: Math.random() * 100,
                experienceMatch: Math.random() * 100
            })).sort((a, b) => b.similarity - a.similarity).slice(0, 10);

            displaySimilarityResults(results);
        }

        function displaySimilarityResults(results) {
            const container = document.getElementById('similarityResults');
            const tbody = document.getElementById('similarityTableBody');
            
            tbody.innerHTML = results.map(candidate => {
                const similarity = Math.round(candidate.similarity);
                const matchLevel = similarity >= 85 ? 'high' : similarity >= 70 ? 'medium' : 'low';
                const matchLabel = similarity >= 85 ? 'HIGH' : similarity >= 70 ? 'MEDIUM' : 'LOW';
                
                return `
                    <tr>
                        <td>
                            <input type="checkbox" onchange="toggleCandidateSelection('${candidate.name}', this.checked)">
                        </td>
                        <td>
                            <div class="font-medium">${candidate.name}</div>
                            <div class="text-sm text-gray-600">${candidate.company}</div>
                        </td>
                        <td>
                            <div class="flex items-center">
                                <span class="font-bold text-lg mr-2">${similarity}%</span>
                                <span class="match-badge match-${matchLevel}">${matchLabel}</span>
                            </div>
                            <div class="similarity-bar">
                                <div class="similarity-fill similarity-${matchLevel}" style="width: ${similarity}%"></div>
                            </div>
                        </td>
                        <td>
                            <div class="text-sm">${Math.round(candidate.skillsMatch)}%</div>
                            <div class="w-16 h-1 bg-gray-200 rounded-full overflow-hidden">
                                <div class="h-full bg-blue-500" style="width: ${candidate.skillsMatch}%"></div>
                            </div>
                        </td>
                        <td>
                            <div class="text-sm">${Math.round(candidate.companyMatch)}%</div>
                            <div class="w-16 h-1 bg-gray-200 rounded-full overflow-hidden">
                                <div class="h-full bg-green-500" style="width: ${candidate.companyMatch}%"></div>
                            </div>
                        </td>
                        <td>
                            <div class="text-sm">${Math.round(candidate.titleMatch)}%</div>
                            <div class="w-16 h-1 bg-gray-200 rounded-full overflow-hidden">
                                <div class="h-full bg-purple-500" style="width: ${candidate.titleMatch}%"></div>
                            </div>
                        </td>
                        <td>
                            <div class="text-sm">${Math.round(candidate.experienceMatch)}%</div>
                            <div class="w-16 h-1 bg-gray-200 rounded-full overflow-hidden">
                                <div class="h-full bg-orange-500" style="width: ${candidate.experienceMatch}%"></div>
                            </div>
                        </td>
                        <td>
                            <button class="btn btn-primary text-xs" onclick="viewSimilarityDetails('${candidate.name}')">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
            
            container.classList.remove('hidden');
        }

        function updateProfileCounts() {
            const topCount = scorelyData.filter(c => c.category === 'TOP').length;
            const goodCount = scorelyData.filter(c => c.category === 'GOOD').length;
            
            document.getElementById('topProfilesCount').textContent = topCount;
            document.getElementById('goodProfilesCount').textContent = goodCount;
        }

        // Auto-Sourcing
        function copyToClipboard(type) {
            let text = '';
            if (type === 'linkedin-boolean') {
                text = '("Backend Engineer" OR "Senior Developer") ("Python" OR "AWS" OR "Kubernetes") ("Wiz" OR "Cybereason" OR "Astrix")';
            } else if (type === 'google-boolean') {
                text = '("Backend Engineer" OR "Senior Developer") Python AWS site:linkedin.com';
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showNotification('Boolean query copied to clipboard!');
            });
        }

        function openLinkedInSearch() {
            const query = '("Backend Engineer" OR "Senior Developer") ("Python" OR "AWS" OR "Kubernetes") ("Wiz" OR "Cybereason" OR "Astrix")';
            const url = `https://www.linkedin.com/search/people/?keywords=${encodeURIComponent(query)}`;
            window.open(url, '_blank');
        }

        // Settings Management
        function loadSettings() {
            // Try to load from environment variables first
            const googleKey = getEnvironmentVariable('GOOGLE_API_KEY') || localStorage.getItem('toply_google_api_key');
            const openaiKey = getEnvironmentVariable('OPENAI_API_KEY') || localStorage.getItem('toply_openai_api_key');
            
            if (googleKey) {
                document.getElementById('googleApiKey').value = '•'.repeat(20);
            }
            if (openaiKey) {
                document.getElementById('openaiApiKey').value = '•'.repeat(20);
            }
        }

        function getEnvironmentVariable(name) {
            // In a real Netlify deployment, this would be available
            return typeof process !== 'undefined' && process.env ? process.env[name] : null;
        }

        function getGoogleApiKey() {
            return getEnvironmentVariable('GOOGLE_API_KEY') || localStorage.getItem('toply_google_api_key');
        }

        function getOpenAIApiKey() {
            return getEnvironmentVariable('OPENAI_API_KEY') || localStorage.getItem('toply_openai_api_key');
        }

        function testGoogleConnection() {
            const apiKey = document.getElementById('googleApiKey').value;
            const statusDiv = document.getElementById('googleConnectionStatus');
            
            if (!apiKey || apiKey.includes('•')) {
                statusDiv.innerHTML = '<div class="text-yellow-600"><i class="fas fa-exclamation-triangle mr-1"></i>Please enter a valid API key</div>';
                return;
            }
            
            // Save the key
            localStorage.setItem('toply_google_api_key', apiKey);
            
            // Simulate connection test
            statusDiv.innerHTML = '<div class="text-blue-600"><i class="fas fa-spinner fa-spin mr-1"></i>Testing connection...</div>';
            
            setTimeout(() => {
                statusDiv.innerHTML = '<div class="text-green-600"><i class="fas fa-check mr-1"></i>Connection successful!</div>';
                showNotification('Google Sheets API connected successfully');
            }, 1500);
        }

        function testOpenAIConnection() {
            const apiKey = document.getElementById('openaiApiKey').value;
            const statusDiv = document.getElementById('openaiConnectionStatus');
            
            if (!apiKey || apiKey.includes('•')) {
                statusDiv.innerHTML = '<div class="text-yellow-600"><i class="fas fa-exclamation-triangle mr-1"></i>Please enter a valid API key</div>';
                return;
            }
            
            // Save the key
            localStorage.setItem('toply_openai_api_key', apiKey);
            
            // Simulate connection test
            statusDiv.innerHTML = '<div class="text-blue-600"><i class="fas fa-spinner fa-spin mr-1"></i>Testing connection...</div>';
            
            setTimeout(() => {
                statusDiv.innerHTML = '<div class="text-green-600"><i class="fas fa-check mr-1"></i>Connection successful!</div>';
                showNotification('OpenAI API connected successfully');
            }, 1500);
        }

        // Utility Functions
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type === 'success' ? 'bg-green-500' : type === 'warning' ? 'bg-yellow-500' : 'bg-red-500'}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function parseCSV(content) {
            const lines = content.split('\n');
            const headers = lines[0].split(',');
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                if (values.length === headers.length) {
                    const item = {};
                    headers.forEach((header, index) => {
                        item[header.trim()] = values[index].trim();
                    });
                    data.push(item);
                }
            }
            return data;
        }

        // Company Functions
        function viewCompanyMatches(companyName) {
            showTab('search');
            document.getElementById('companyFilter').value = companyName;
            searchCandidates();
        }

        function trackCompany(companyName) {
            showNotification(`Now tracking ${companyName} for candidate activity`);
        }

        function viewSimilarityDetails(candidateName) {
            showNotification(`Detailed analysis for ${candidateName} coming soon`);
        }
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDqXCu8MzcLDFsyGFH5jp98om25dCvkXepvX02Hb4vZ20BygegKRTNSyvPzMVtpslND0DIq9aGt32vQgSj4O91E6LRyBT1OgTeXCyZCW%2ByO%2FHWX8hYT4F2u0orNyEXLKBxsdFhIBqXmnx3hPHH7j3sxhYQUNdo3%2FFh8uMutAUDnwbMvTv6b8UUIRYnCWObTpRUbecQUk3qbYYqZ%2BqOAW52AP5NlSqIA%2BdMsFxeIz5hpVXmKIC7APaoMws%2B%2Fgy1%2BplCtDdK7si%2FLLbomkSH3WMRbicQhpLrRxEyxCVNhkiMWfe0T6xq0uKIjumn2YfjmxxYWfB04AMMI3BgjsI8C39pTL1kYCOyKnXKTcFjaQKXIwfkaJDw%2FXwEf5UrDavf0u9SYiRrTKH2iOdJH%2FkJGFyjOCT6o2zEOXDMr7fPMtxKeaYYRcraNg%2FPuI%2BIiFvN%2FFIIUspaS76Tji3m5p1GdhgdOZaW0mrJApEWZ9fbgWo%2BqVUTHQ1RCmEA8F%2FsUJUvtHPXg%3D%3D";
        window.__genspark_locale = "en-US";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDqXCu8MzcLDFsyGFH5jp98om25dCvkXepvX02Hb4vZ20BygegKRTNSyvPzMVtpslND0DIq9aGt32vQgSj4O91E6LRyBT1OgTeXCyZCW+yO/HWX8hYT4F2u0orNyEXLKBxsdFhIBqXmnx3hPHH7j3sxhYQUNdo3/Fh8uMutAUDnwbMvTv6b8UUIRYnCWObTpRUbecQUk3qbYYqZ+qOAW52AP5NlSqIA+dMsFxeIz5hpVXmKIC7APaoMws+/gy1+plCtDdK7si/LLbomkSH3WMRbicQhpLrRxEyxCVNhkiMWfe0T6xq0uKIjumn2YfjmxxYWfB04AMMI3BgjsI8C39pTL1kYCOyKnXKTcFjaQKXIwfkaJDw/XwEf5UrDavf0u9SYiRrTKH2iOdJH/kJGFyjOCT6o2zEOXDMr7fPMtxKeaYYRcraNg/PuI+IiFvN/FIIUspaS76Tji3m5p1GdhgdOZaW0mrJApEWZ9fbgWo+qVUTHQ1RCmEA8F/sUJUvtHPXg==";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
