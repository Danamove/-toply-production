<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toply - AI Recruitment Intelligence Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover { transition: transform 0.2s, box-shadow 0.2s; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .similarity-bar { background: linear-gradient(90deg, #10b981 0%, #3b82f6 50%, #8b5cf6 100%); }
        .toast { position: fixed; top: 20px; right: 20px; z-index: 1000; }
        .hidden { display: none; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .user-indicator { 
            display: inline-block; 
            width: 10px; 
            height: 10px; 
            border-radius: 50%; 
            background: #10b981; 
            margin-right: 8px; 
        }
        .guest-indicator { background: #6b7280; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <i class="fas fa-brain text-3xl mr-3"></i>
                    <h1 class="text-2xl font-bold">Toply Intelligence Hub</h1>
                    <span class="ml-3 text-sm opacity-80">Advanced Recruitment Intelligence Platform</span>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- User Selector -->
                    <div class="relative">
                        <select id="userSelect" class="bg-white bg-opacity-20 text-white px-4 py-2 rounded-lg border border-white border-opacity-30 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50">
                            <option value="">Select User</option>
                            <option value="guest">ðŸ‘¤ Continue as Guest</option>
                            <option value="dana">Dana</option>
                            <option value="alexey">Alexey</option>
                            <option value="katinka">Katinka</option>
                            <option value="shiri">Shiri</option>
                            <option value="mika">Mika</option>
                            <option value="chen">Chen</option>
                            <option value="andrea">Andrea</option>
                            <option value="eszter">Eszter</option>
                            <option value="danana">Danana</option>
                        </select>
                    </div>
                    <!-- Selected Candidates Counter -->
                    <button id="selectedCandidatesBtn" class="bg-white bg-opacity-20 px-4 py-2 rounded-lg border border-white border-opacity-30 hover:bg-opacity-30 transition-colors">
                        <i class="fas fa-list mr-2"></i>
                        <span id="selectedCount">Selected (0)</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- User Status Bar -->
    <div id="userStatusBar" class="bg-blue-50 border-b border-blue-200 px-6 py-2 hidden">
        <div class="container mx-auto">
            <div id="userStatus" class="text-sm text-blue-700"></div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b">
        <div class="container mx-auto px-6">
            <div class="flex space-x-8">
                <button class="tab-btn px-4 py-4 text-red-600 border-b-2 border-red-600 font-medium" data-tab="dashboard">
                    <i class="fas fa-chart-line mr-2"></i>Hot Signals Dashboard
                </button>
                <button class="tab-btn px-4 py-4 text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 font-medium" data-tab="search">
                    <i class="fas fa-search mr-2"></i>Smart Search
                </button>
                <button class="tab-btn px-4 py-4 text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 font-medium" data-tab="similarity">
                    <i class="fas fa-brain mr-2"></i>AI Matching
                </button>
                <button class="tab-btn px-4 py-4 text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 font-medium" data-tab="sourcing">
                    <i class="fas fa-robot mr-2"></i>Active Tracking
                </button>
                <button class="tab-btn px-4 py-4 text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 font-medium" data-tab="companies">
                    <i class="fas fa-building mr-2"></i>Companies
                </button>
                <button class="tab-btn px-4 py-4 text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 font-medium" data-tab="analytics">
                    <i class="fas fa-chart-bar mr-2"></i>Analytics
                </button>
                <button class="tab-btn px-4 py-4 text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 font-medium" data-tab="settings">
                    <i class="fas fa-cog mr-2"></i>Settings
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-blue-500 text-white p-6 rounded-lg shadow-lg card-hover cursor-pointer" data-action="hotCompanies">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold mb-2">Hot Companies</h3>
                            <p class="text-3xl font-bold">28</p>
                        </div>
                        <i class="fas fa-fire text-4xl opacity-80"></i>
                    </div>
                </div>
                
                <div class="bg-green-500 text-white p-6 rounded-lg shadow-lg card-hover cursor-pointer" data-action="activeCandidates">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold mb-2">Active Candidates</h3>
                            <p class="text-3xl font-bold">100+</p>
                        </div>
                        <i class="fas fa-users text-4xl opacity-80"></i>
                    </div>
                </div>
                
                <div class="bg-red-500 text-white p-6 rounded-lg shadow-lg card-hover cursor-pointer" data-action="newAlerts">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold mb-2">New Alerts</h3>
                            <p class="text-3xl font-bold">7</p>
                        </div>
                        <i class="fas fa-bell text-4xl opacity-80"></i>
                    </div>
                </div>
                
                <div class="bg-purple-500 text-white p-6 rounded-lg shadow-lg card-hover cursor-pointer" data-action="totalProfiles">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold mb-2">Total Profiles</h3>
                            <p class="text-3xl font-bold">396</p>
                        </div>
                        <i class="fas fa-star text-4xl opacity-80"></i>
                    </div>
                </div>
            </div>

            <!-- Priority Recommendations -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h2 class="text-xl font-bold mb-4 flex items-center">
                    <i class="fas fa-bullseye mr-2 text-red-500"></i>
                    Today's Priority Recommendations
                </h2>
                
                <div class="space-y-4">
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                        <h3 class="font-semibold text-red-800 mb-2">Contact candidates from Microsoft immediately</h3>
                        <p class="text-red-700">3 active candidates + recent layoffs = 85% response rate expected</p>
                    </div>
                    
                    <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
                        <h3 class="font-semibold text-orange-800 mb-2">Unity talent surge detected</h3>
                        <p class="text-orange-700">3 candidates from Unity - consider Gaming/Mobile opportunities</p>
                    </div>
                    
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                        <h3 class="font-semibold text-blue-800 mb-2">Security sector opportunity</h3>
                        <p class="text-blue-700">Review 12 new Security professionals this week</p>
                    </div>
                </div>
            </div>

            <!-- Market Intelligence -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-chart-line mr-2 text-blue-500"></i>
                        Market Intelligence
                    </h2>
                    
                    <div class="space-y-4">
                        <h3 class="font-semibold text-gray-800">This Week's Intelligence</h3>
                        <ul class="space-y-2 text-gray-600">
                            <li class="flex items-center"><i class="fas fa-arrow-up text-green-500 mr-2"></i>Security sector: 23% more active candidates</li>
                            <li class="flex items-center"><i class="fas fa-fire text-red-500 mr-2"></i>Backend roles: High demand detected</li>
                            <li class="flex items-center"><i class="fas fa-chart-line text-blue-500 mr-2"></i>Microsoft candidates: 85% response rate</li>
                        </ul>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-clock mr-2 text-green-500"></i>
                        Best Timing Recommendations
                    </h2>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-3 bg-red-50 rounded">
                            <span class="font-medium">Wiz candidates</span>
                            <span class="text-red-600 font-semibold">Contact now (layoffs detected)</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-orange-50 rounded">
                            <span class="font-medium">Microsoft window</span>
                            <span class="text-orange-600 font-semibold">Next 2 weeks optimal</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-blue-50 rounded">
                            <span class="font-medium">Q1 hiring surge</span>
                            <span class="text-blue-600 font-semibold">Prepare candidate pipeline</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Similarity Search Tab -->
        <div id="similarity" class="tab-content">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold mb-6 flex items-center">
                    <i class="fas fa-brain mr-2 text-purple-500"></i>
                    AI Similarity Search
                </h2>

                <!-- Upload Section -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Upload Scorely Results</h3>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors">
                        <input type="file" id="scorelyUpload" accept=".json,.csv" class="hidden">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                        <p class="text-lg mb-2">Drag & drop Scorely JSON file here</p>
                        <p class="text-sm text-gray-500 mb-4">or click to browse</p>
                        <button onclick="document.getElementById('scorelyUpload').click()" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                            Choose File
                        </button>
                        <p class="text-xs text-gray-400 mt-2">Supports: .json, .csv files with embeddings</p>
                    </div>
                </div>

                <!-- Search Input -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Find Similar Candidates</h3>
                    <div class="flex gap-4">
                        <textarea id="similarityQuery" rows="3" class="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter job description, candidate profile, or company description..."></textarea>
                        <button id="findSimilarBtn" class="bg-purple-500 text-white px-6 py-2 rounded-lg hover:bg-purple-600 transition-colors">
                            <i class="fas fa-search mr-2"></i>Find Similar
                        </button>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="similarityResults" class="hidden">
                    <h3 class="text-lg font-semibold mb-4">Similarity Results</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Select</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Candidate</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Overall Match</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Skills</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Experience</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Details</th>
                                </tr>
                            </thead>
                            <tbody id="similarityResultsBody" class="bg-white divide-y divide-gray-200">
                                <!-- Results will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Auto-Sourcing Tab -->
        <div id="sourcing" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Success Patterns -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-chart-pie mr-2 text-green-500"></i>
                        Success Patterns Analysis
                    </h2>

                    <div class="space-y-6">
                        <!-- Top Companies -->
                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800">Top Companies</h3>
                            <div class="space-y-2">
                                <div class="flex items-center justify-between p-2 bg-blue-50 rounded">
                                    <span>Wiz</span>
                                    <span class="bg-blue-500 text-white px-2 py-1 rounded text-sm">3 TOP</span>
                                </div>
                                <div class="flex items-center justify-between p-2 bg-green-50 rounded">
                                    <span>Cybereason</span>
                                    <span class="bg-green-500 text-white px-2 py-1 rounded text-sm">2 TOP</span>
                                </div>
                                <div class="flex items-center justify-between p-2 bg-purple-50 rounded">
                                    <span>Astrix</span>
                                    <span class="bg-purple-500 text-white px-2 py-1 rounded text-sm">2 TOP</span>
                                </div>
                            </div>
                        </div>

                        <!-- Top Skills -->
                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800">Top Skills</h3>
                            <div class="space-y-2">
                                <div class="flex items-center justify-between">
                                    <span>Python</span>
                                    <div class="flex items-center">
                                        <div class="w-20 h-2 bg-gray-200 rounded mr-2">
                                            <div class="w-4/5 h-2 bg-blue-500 rounded"></div>
                                        </div>
                                        <span class="text-sm">85%</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span>AWS</span>
                                    <div class="flex items-center">
                                        <div class="w-20 h-2 bg-gray-200 rounded mr-2">
                                            <div class="w-3/4 h-2 bg-green-500 rounded"></div>
                                        </div>
                                        <span class="text-sm">78%</span>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span>Kubernetes</span>
                                    <div class="flex items-center">
                                        <div class="w-20 h-2 bg-gray-200 rounded mr-2">
                                            <div class="w-3/5 h-2 bg-purple-500 rounded"></div>
                                        </div>
                                        <span class="text-sm">71%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Boolean Queries -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-code mr-2 text-blue-500"></i>
                        Generated Boolean Queries
                    </h2>

                    <div class="space-y-6">
                        <!-- LinkedIn Boolean -->
                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800">LinkedIn Boolean Query</h3>
                            <div class="bg-gray-50 p-4 rounded border">
                                <code class="text-sm">
                                    ("Backend Engineer" OR "Senior Developer") AND ("Python" OR "AWS" OR "Kubernetes") AND ("Wiz" OR "Cybereason" OR "Astrix")
                                </code>
                            </div>
                            <div class="mt-2 space-x-2">
                                <button class="bg-blue-500 text-white px-4 py-2 rounded text-sm hover:bg-blue-600">
                                    <i class="fas fa-copy mr-1"></i>Copy
                                </button>
                                <button class="bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700">
                                    <i class="fab fa-linkedin mr-1"></i>Open in LinkedIn
                                </button>
                            </div>
                        </div>

                        <!-- Google Boolean -->
                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800">Google Boolean Query</h3>
                            <div class="bg-gray-50 p-4 rounded border">
                                <code class="text-sm">
                                    "Backend Engineer" OR "Senior Developer" AND Python AND AWS site:linkedin.com
                                </code>
                            </div>
                            <div class="mt-2">
                                <button class="bg-red-500 text-white px-4 py-2 rounded text-sm hover:bg-red-600">
                                    <i class="fas fa-copy mr-1"></i>Copy
                                </button>
                            </div>
                        </div>

                        <!-- Smart Suggestions -->
                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800">Smart Sourcing Suggestions</h3>
                            <div class="space-y-2 text-sm">
                                <div class="bg-blue-50 p-3 rounded">
                                    <i class="fas fa-lightbulb text-blue-500 mr-2"></i>
                                    Try targeting Backend Engineers at Check Point
                                    <p class="text-gray-600 ml-6">Similar security company profile to your successful Wiz hires</p>
                                </div>
                                <div class="bg-green-50 p-3 rounded">
                                    <i class="fas fa-search text-green-500 mr-2"></i>
                                    Look for Python developers with 5+ years experience
                                    <p class="text-gray-600 ml-6">82% success rate in your previous TOP-rated candidates</p>
                                </div>
                                <div class="bg-purple-50 p-3 rounded">
                                    <i class="fas fa-users text-purple-500 mr-2"></i>
                                    Consider DevOps from Security companies
                                    <p class="text-gray-600 ml-6">80% skill overlap with your successful Backend Engineer hires</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Smart Search Tab -->
        <div id="search" class="tab-content">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold mb-6 flex items-center">
                    <i class="fas fa-search mr-2 text-blue-500"></i>
                    Smart Candidate Search
                </h2>

                <!-- Search Filters -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Job Title / Role</label>
                        <input type="text" id="jobTitle" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g. Backend Engineer">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Skills</label>
                        <input type="text" id="skills" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder='Use "," for AND, "OR" for either'>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Experience Level</label>
                        <select id="experience" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Any Experience</option>
                            <option value="junior">Junior (0-2 years)</option>
                            <option value="mid">Mid (3-5 years)</option>
                            <option value="senior">Senior (6+ years)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Location</label>
                        <input type="text" id="location" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g. Tel Aviv">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Company Filter</label>
                        <input type="text" id="companyFilter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g. Wiz, Microsoft">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Score Range</label>
                        <select id="scoreRange" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Any Score</option>
                            <option value="top">TOP (80-100)</option>
                            <option value="good">GOOD (60-79)</option>
                            <option value="average">Average (40-59)</option>
                        </select>
                    </div>
                </div>

                <!-- Advanced Filters -->
                <div class="flex flex-wrap gap-4 mb-6">
                    <label class="flex items-center">
                        <input type="checkbox" id="lookingOnly" class="mr-2">
                        <span class="text-sm">Show only LOOKING candidates</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="hotCompaniesOnly" class="mr-2">
                        <span class="text-sm">Show only from Hot Companies</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="unviewedOnly" class="mr-2">
                        <span class="text-sm">Show only unviewed (this week)</span>
                    </label>
                </div>

                <!-- Search Button -->
                <div class="mb-6">
                    <button id="searchCandidatesBtn" class="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors">
                        <i class="fas fa-search mr-2"></i>Search Candidates
                    </button>
                    <button id="resetSearchBtn" class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors ml-2">
                        <i class="fas fa-undo mr-2"></i>Reset
                    </button>
                </div>

                <!-- Results Table -->
                <div id="searchResults" class="hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Search Results</h3>
                        <div class="space-x-2">
                            <button id="exportSelectedBtn" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-colors">
                                <i class="fas fa-download mr-1"></i>Export Selected
                            </button>
                            <button id="selectAllBtn" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors">
                                <i class="fas fa-check-square mr-1"></i>Select All
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Select</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Candidate</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Experience</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Score</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="searchResultsBody" class="bg-white divide-y divide-gray-200">
                                <!-- Results will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Companies Tab -->
        <div id="companies" class="tab-content">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold mb-6 flex items-center">
                    <i class="fas fa-building mr-2 text-green-500"></i>
                    Companies Intelligence
                </h2>

                <!-- Company Filters -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Industry</label>
                        <select id="industryFilter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">All Industries</option>
                            <option value="cybersecurity">Cybersecurity</option>
                            <option value="fintech">FinTech</option>
                            <option value="ai">AI/ML</option>
                            <option value="cloud">Cloud</option>
                            <option value="mobile">Mobile</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Company Size</label>
                        <select id="sizeFilter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">All Sizes</option>
                            <option value="startup">Startup (1-50)</option>
                            <option value="medium">Medium (51-500)</option>
                            <option value="large">Large (500+)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                        <select id="statusFilter" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">All Statuses</option>
                            <option value="hot">Hot Companies</option>
                            <option value="unicorn">Unicorns</option>
                            <option value="public">Public Companies</option>
                        </select>
                    </div>
                </div>

                <!-- Hot Companies Section -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-fire mr-2 text-red-500"></i>
                        Hot Companies This Week
                    </h3>
                    <p class="text-gray-600 mb-4">Companies with recent activity - higher candidate response rates expected</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="border border-red-200 bg-red-50 p-4 rounded-lg">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold">Microsoft</h4>
                                <span class="bg-red-500 text-white px-2 py-1 rounded text-xs">LAYOFFS</span>
                            </div>
                            <p class="text-sm text-gray-600 mb-2">Big Tech | Global | 1000+ employees</p>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-red-600 font-medium">3 active candidates</span>
                                <button class="text-blue-500 hover:text-blue-700 text-sm">View Candidates</button>
                            </div>
                        </div>

                        <div class="border border-orange-200 bg-orange-50 p-4 rounded-lg">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold">Unity</h4>
                                <span class="bg-orange-500 text-white px-2 py-1 rounded text-xs">LAYOFFS</span>
                            </div>
                            <p class="text-sm text-gray-600 mb-2">Gaming | Global | 500+ employees</p>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-orange-600 font-medium">3 active candidates</span>
                                <button class="text-blue-500 hover:text-blue-700 text-sm">View Candidates</button>
                            </div>
                        </div>

                        <div class="border border-red-200 bg-red-50 p-4 rounded-lg">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-semibold">Wiz</h4>
                                <span class="bg-red-500 text-white px-2 py-1 rounded text-xs">EXODUS</span>
                            </div>
                            <p class="text-sm text-gray-600 mb-2">Security | Unicorn | 750 employees</p>
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-red-600 font-medium">1 active candidate</span>
                                <button class="text-blue-500 hover:text-blue-700 text-sm">View Candidates</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- All Companies Table -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">All Companies Database</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Industry</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Size</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Active Candidates</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-4 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <div class="w-2 h-2 bg-red-500 rounded-full mr-2"></div>
                                            <span class="font-medium">Microsoft</span>
                                        </div>
                                    </td>
                                    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">Big Tech</td>
                                    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">1000+</td>
                                    <td class="px-4 py-4 whitespace-nowrap">
                                        <span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs">Hot</span>
                                    </td>
                                    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">3</td>
                                    <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
                                        <button class="text-blue-600 hover:text-blue-900">View Details</button>
                                    </td>
                                </tr>
                                <!-- More rows would be added dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analytics" class="tab-content">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold mb-6 flex items-center">
                    <i class="fas fa-chart-bar mr-2 text-purple-500"></i>
                    Analytics
                </h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold mb-4">Search Activity</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Total Searches</span>
                                <span class="font-medium">1,247</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Success Rate</span>
                                <span class="font-medium text-green-600">89%</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Avg Results Per Search</span>
                                <span class="font-medium">4.2</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-semibold mb-4">Platform Usage</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Active Users</span>
                                <span class="font-medium">9</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Candidates Viewed</span>
                                <span class="font-medium">2,891</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Exports Generated</span>
                                <span class="font-medium">156</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold mb-6 flex items-center">
                    <i class="fas fa-cog mr-2 text-gray-500"></i>
                    Settings & Integrations
                </h2>

                <!-- Google Sheets Integration -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Google Sheets Integration</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Google Sheets API Key</label>
                            <div class="flex space-x-2">
                                <input type="password" id="googleApiKey" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your Google Sheets API key">
                                <button id="testGoogleConnection" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
                                    <i class="fas fa-check mr-1"></i>Test Connection
                                </button>
                            </div>
                            <div id="googleConnectionStatus" class="mt-2 text-sm hidden"></div>
                        </div>
                    </div>
                </div>

                <!-- OpenAI Integration -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">OpenAI Integration</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">OpenAI API Key</label>
                            <div class="flex space-x-2">
                                <input type="password" id="openaiApiKey" class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your OpenAI API key">
                                <button id="testOpenAIConnection" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
                                    <i class="fas fa-check mr-1"></i>Test Connection
                                </button>
                            </div>
                            <div id="openaiConnectionStatus" class="mt-2 text-sm hidden"></div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Model Selection</label>
                            <select id="openaiModel" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="text-embedding-3-small">text-embedding-3-small (Recommended)</option>
                                <option value="text-embedding-3-large">text-embedding-3-large</option>
                                <option value="text-embedding-ada-002">text-embedding-ada-002</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Data Sources -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Data Sources</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium">Active Candidates</h4>
                                <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Connected</span>
                            </div>
                            <p class="text-sm text-gray-600">100+ candidates actively looking for opportunities</p>
                        </div>
                        
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium">Hot Companies</h4>
                                <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Connected</span>
                            </div>
                            <p class="text-sm text-gray-600">28 companies with recent market events</p>
                        </div>
                        
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium">Companies Database</h4>
                                <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Connected</span>
                            </div>
                            <p class="text-sm text-gray-600">396 companies with detailed intelligence</p>
                        </div>
                        
                        <div class="border border-gray-200 rounded-lg p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium">Scorely Results</h4>
                                <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs">Upload Required</span>
                            </div>
                            <p class="text-sm text-gray-600">TOP and GOOD candidate profiles with embeddings</p>
                        </div>
                    </div>
                </div>

                <!-- Advanced Settings -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold mb-4">Advanced Settings</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Similarity Threshold</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="similarityThreshold" min="0" max="100" value="50" class="flex-1">
                                <span id="thresholdValue" class="text-sm font-medium">50%</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">Minimum similarity score to show results</p>
                        </div>
                        
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="autoSaveSettings" class="rounded">
                            <label for="autoSaveSettings" class="text-sm">Save settings automatically</label>
                        </div>
                        
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="cacheEmbeddings" class="rounded" checked>
                            <label for="cacheEmbeddings" class="text-sm">Cache embeddings locally to save API costs</label>
                        </div>
                    </div>
                </div>

                <!-- Save Settings -->
                <div class="flex space-x-4">
                    <button id="saveSettingsBtn" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">
                        <i class="fas fa-save mr-2"></i>Save Settings
                    </button>
                    <button id="resetSettingsBtn" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                        <i class="fas fa-undo mr-2"></i>Reset to Defaults
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Selected Candidates Sidebar -->
    <div id="selectedCandidatesSidebar" class="fixed right-0 top-0 h-full w-80 bg-white shadow-lg transform translate-x-full transition-transform z-50">
        <div class="p-6 h-full flex flex-col">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold">Selected Candidates</h3>
                <button id="closeSidebar" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="selectedCandidatesList" class="flex-1 overflow-y-auto">
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-users text-4xl mb-4 opacity-50"></i>
                    <p>No candidates selected</p>
                </div>
            </div>
            
            <div class="mt-4 space-y-2">
                <button id="exportCSVBtn" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition-colors">
                    <i class="fas fa-download mr-2"></i>Export CSV
                </button>
                <button id="exportLinkedInBtn" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors">
                    <i class="fab fa-linkedin mr-2"></i>Export LinkedIn URLs
                </button>
                <button id="clearAllBtn" class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors">
                    <i class="fas fa-trash mr-2"></i>Clear All
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden">
        <div class="bg-white border border-gray-200 rounded-lg shadow-lg p-4 min-w-72">
            <div class="flex items-center">
                <div id="toastIcon" class="mr-3"></div>
                <div id="toastMessage" class="text-sm"></div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let selectedCandidates = [];
        let currentUser = '';
        let viewedCandidates = {};
        let allCandidates = [];
        let scorelyData = [];
        let settings = {
            googleApiKey: '',
            openaiApiKey: '',
            openaiModel: 'text-embedding-3-small',
            similarityThreshold: 50,
            autoSaveSettings: false,
            cacheEmbeddings: true
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            initializeEventListeners();
            loadMockData();
            updateUserStatus();
        });

        // Load settings from localStorage
        function loadSettings() {
            const savedSettings = localStorage.getItem('toplySettings');
            if (savedSettings) {
                settings = { ...settings, ...JSON.parse(savedSettings) };
                
                // Populate form fields
                document.getElementById('googleApiKey').value = settings.googleApiKey;
                document.getElementById('openaiApiKey').value = settings.openaiApiKey;
                document.getElementById('openaiModel').value = settings.openaiModel;
                document.getElementById('similarityThreshold').value = settings.similarityThreshold;
                document.getElementById('thresholdValue').textContent = settings.similarityThreshold + '%';
                document.getElementById('autoSaveSettings').checked = settings.autoSaveSettings;
                document.getElementById('cacheEmbeddings').checked = settings.cacheEmbeddings;
            }
        }

        // Save settings to localStorage
        function saveSettings() {
            settings.googleApiKey = document.getElementById('googleApiKey').value;
            settings.openaiApiKey = document.getElementById('openaiApiKey').value;
            settings.openaiModel = document.getElementById('openaiModel').value;
            settings.similarityThreshold = parseInt(document.getElementById('similarityThreshold').value);
            settings.autoSaveSettings = document.getElementById('autoSaveSettings').checked;
            settings.cacheEmbeddings = document.getElementById('cacheEmbeddings').checked;
            
            localStorage.setItem('toplySettings', JSON.stringify(settings));
            showToast('Settings saved successfully!', 'success');
        }

        // Test Google Sheets connection
        async function testGoogleConnection() {
            const apiKey = document.getElementById('googleApiKey').value.trim();
            const statusElement = document.getElementById('googleConnectionStatus');
            
            if (!apiKey) {
                showConnectionStatus('googleConnectionStatus', 'Please enter an API key', 'error');
                return;
            }

            try {
                statusElement.className = 'mt-2 text-sm text-blue-600';
                statusElement.textContent = 'Testing connection...';
                statusElement.classList.remove('hidden');

                // Test with a simple Google Sheets API call
                const testUrl = `https://sheets.googleapis.com/v4/spreadsheets/1It9bHPbIRXX3Ezf_-phAZvyE3SYMbd1zt7PlkrLX-HU?key=${apiKey}`;
                const response = await fetch(testUrl);
                
                if (response.ok) {
                    showConnectionStatus('googleConnectionStatus', 'Connection successful!', 'success');
                    if (settings.autoSaveSettings) {
                        settings.googleApiKey = apiKey;
                        localStorage.setItem('toplySettings', JSON.stringify(settings));
                    }
                } else {
                    showConnectionStatus('googleConnectionStatus', 'Connection failed: Invalid API key or permissions', 'error');
                }
            } catch (error) {
                showConnectionStatus('googleConnectionStatus', 'Connection failed: ' + error.message, 'error');
            }
        }

        // Test OpenAI connection
        async function testOpenAIConnection() {
            const apiKey = document.getElementById('openaiApiKey').value.trim();
            const statusElement = document.getElementById('openaiConnectionStatus');
            
            if (!apiKey) {
                showConnectionStatus('openaiConnectionStatus', 'Please enter an API key', 'error');
                return;
            }

            try {
                statusElement.className = 'mt-2 text-sm text-blue-600';
                statusElement.textContent = 'Testing connection...';
                statusElement.classList.remove('hidden');

                const response = await fetch('https://api.openai.com/v1/models', {
                    headers: {
                        'Authorization': `Bearer ${apiKey}`
                    }
                });
                
                if (response.ok) {
                    showConnectionStatus('openaiConnectionStatus', 'Connection successful!', 'success');
                    if (settings.autoSaveSettings) {
                        settings.openaiApiKey = apiKey;
                        localStorage.setItem('toplySettings', JSON.stringify(settings));
                    }
                } else {
                    showConnectionStatus('openaiConnectionStatus', 'Connection failed: Invalid API key', 'error');
                }
            } catch (error) {
                showConnectionStatus('openaiConnectionStatus', 'Connection failed: ' + error.message, 'error');
            }
        }

        // Show connection status
        function showConnectionStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.classList.remove('hidden');
            
            if (type === 'success') {
                element.className = 'mt-2 text-sm text-green-600';
                element.innerHTML = `<i class="fas fa-check-circle mr-1"></i>${message}`;
            } else if (type === 'error') {
                element.className = 'mt-2 text-sm text-red-600';
                element.innerHTML = `<i class="fas fa-exclamation-circle mr-1"></i>${message}`;
            } else {
                element.className = 'mt-2 text-sm text-blue-600';
                element.innerHTML = `<i class="fas fa-info-circle mr-1"></i>${message}`;
            }
        }

        // Initialize event listeners
        function initializeEventListeners() {
            // Tab navigation
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => switchTab(btn.dataset.tab));
            });

            // User selector
            document.getElementById('userSelect').addEventListener('change', function() {
                currentUser = this.value;
                updateUserStatus();
            });

            // Settings
            document.getElementById('saveSettingsBtn').addEventListener('click', saveSettings);
            document.getElementById('resetSettingsBtn').addEventListener('click', resetSettings);
            document.getElementById('testGoogleConnection').addEventListener('click', testGoogleConnection);
            document.getElementById('testOpenAIConnection').addEventListener('click', testOpenAIConnection);
            
            // Similarity threshold slider
            document.getElementById('similarityThreshold').addEventListener('input', function() {
                document.getElementById('thresholdValue').textContent = this.value + '%';
            });

            // Selected candidates sidebar
            document.getElementById('selectedCandidatesBtn').addEventListener('click', toggleSelectedSidebar);
            document.getElementById('closeSidebar').addEventListener('click', toggleSelectedSidebar);

            // Export buttons
            document.getElementById('exportCSVBtn').addEventListener('click', exportSelectedCSV);
            document.getElementById('exportLinkedInBtn').addEventListener('click', exportLinkedInURLs);
            document.getElementById('clearAllBtn').addEventListener('click', clearSelectedCandidates);

            // Dashboard cards
            document.querySelectorAll('[data-action]').forEach(card => {
                card.addEventListener('click', function() {
                    const action = this.dataset.action;
                    handleDashboardAction(action);
                });
            });

            // File upload
            document.getElementById('scorelyUpload').addEventListener('change', handleFileUpload);

            // Search
            document.getElementById('searchCandidatesBtn').addEventListener('click', searchCandidates);
            document.getElementById('resetSearchBtn').addEventListener('click', resetSearch);
        }

        // Switch tabs
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.className = 'tab-btn px-4 py-4 text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600 font-medium';
            });
            
            const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
            if (tabName === 'dashboard') {
                activeBtn.className = 'tab-btn px-4 py-4 text-red-600 border-b-2 border-red-600 font-medium';
            } else {
                activeBtn.className = 'tab-btn px-4 py-4 text-blue-600 border-b-2 border-blue-600 font-medium';
            }

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
        }

        // Update user status
        function updateUserStatus() {
            const statusBar = document.getElementById('userStatusBar');
            const statusText = document.getElementById('userStatus');
            
            if (currentUser) {
                statusBar.classList.remove('hidden');
                if (currentUser === 'guest') {
                    statusText.innerHTML = '<span class="guest-indicator"></span>You\'re browsing as Guest. Select your name above for personal tracking and saved lists.';
                } else {
                    const userName = currentUser.charAt(0).toUpperCase() + currentUser.slice(1);
                    statusText.innerHTML = `<span class="user-indicator"></span>Welcome ${userName}! Your personal workspace is active.`;
                }
            } else {
                statusBar.classList.add('hidden');
            }
        }

        // Handle dashboard actions
        function handleDashboardAction(action) {
            switch(action) {
                case 'hotCompanies':
                    switchTab('companies');
                    break;
                case 'activeCandidates':
                    switchTab('search');
                    document.getElementById('lookingOnly').checked = true;
                    searchCandidates();
                    break;
                case 'newAlerts':
                    // Show alerts or notifications
                    showToast('7 new alerts available for review', 'info');
                    break;
                case 'totalProfiles':
                    switchTab('search');
                    break;
            }
        }

        // Load mock data
        function loadMockData() {
            // Mock active candidates data
            allCandidates = [
                {
                    id: 1,
                    name: 'Dana M.',
                    company: 'Wiz',
                    title: 'Senior Backend Engineer',
                    experience: '5 years',
                    skills: ['Python', 'AWS', 'Docker'],
                    linkedin: 'https://linkedin.com/in/danam',
                    status: 'LOOKING',
                    score: 87,
                    category: 'TOP',
                    isHotCompany: true
                },
                {
                    id: 2,
                    name: 'Yoav S.',
                    company: 'Unity',
                    title: 'Senior Developer',
                    experience: '6 years',
                    skills: ['C#', 'Unity3D', 'Mobile'],
                    linkedin: 'https://linkedin.com/in/yoavs',
                    status: 'LOOKING',
                    score: 82,
                    category: 'GOOD',
                    isHotCompany: true
                },
                {
                    id: 3,
                    name: 'Sarah L.',
                    company: 'Microsoft',
                    title: 'Software Engineer',
                    experience: '4 years',
                    skills: ['JavaScript', 'React', 'Node.js'],
                    linkedin: 'https://linkedin.com/in/sarahl',
                    status: 'LOOKING',
                    score: 78,
                    category: 'GOOD',
                    isHotCompany: true
                },
                {
                    id: 4,
                    name: 'Mike T.',
                    company: 'Google',
                    title: 'Frontend Developer',
                    experience: '3 years',
                    skills: ['React', 'TypeScript', 'GraphQL'],
                    linkedin: 'https://linkedin.com/in/miket',
                    status: 'OPEN',
                    score: 65,
                    category: 'GOOD',
                    isHotCompany: false
                }
            ];
        }

        // Search candidates
        function searchCandidates() {
            const jobTitle = document.getElementById('jobTitle').value.toLowerCase();
            const skills = document.getElementById('skills').value.toLowerCase();
            const experience = document.getElementById('experience').value;
            const location = document.getElementById('location').value.toLowerCase();
            const companyFilter = document.getElementById('companyFilter').value.toLowerCase();
            const scoreRange = document.getElementById('scoreRange').value;
            const lookingOnly = document.getElementById('lookingOnly').checked;
            const hotCompaniesOnly = document.getElementById('hotCompaniesOnly').checked;
            const unviewedOnly = document.getElementById('unviewedOnly').checked;

            let filteredCandidates = allCandidates.filter(candidate => {
                // Job title filter
                if (jobTitle && !candidate.title.toLowerCase().includes(jobTitle)) {
                    return false;
                }

                // Skills filter
                if (skills) {
                    const skillsArray = skills.split(',').map(s => s.trim());
                    const hasSkills = skillsArray.some(skill => 
                        candidate.skills.some(candidateSkill => 
                            candidateSkill.toLowerCase().includes(skill)
                        )
                    );
                    if (!hasSkills) return false;
                }

                // Experience filter
                if (experience) {
                    const expYears = parseInt(candidate.experience);
                    switch(experience) {
                        case 'junior':
                            if (expYears > 2) return false;
                            break;
                        case 'mid':
                            if (expYears < 3 || expYears > 5) return false;
                            break;
                        case 'senior':
                            if (expYears < 6) return false;
                            break;
                    }
                }

                // Location filter
                if (location && !candidate.location?.toLowerCase().includes(location)) {
                    // For demo, assume all candidates are in Tel Aviv
                }

                // Company filter
                if (companyFilter && !candidate.company.toLowerCase().includes(companyFilter)) {
                    return false;
                }

                // Score range filter
                if (scoreRange) {
                    switch(scoreRange) {
                        case 'top':
                            if (candidate.score < 80) return false;
                            break;
                        case 'good':
                            if (candidate.score < 60 || candidate.score >= 80) return false;
                            break;
                        case 'average':
                            if (candidate.score < 40 || candidate.score >= 60) return false;
                            break;
                    }
                }

                // Looking only filter
                if (lookingOnly && candidate.status !== 'LOOKING') {
                    return false;
                }

                // Hot companies only filter
                if (hotCompaniesOnly && !candidate.isHotCompany) {
                    return false;
                }

                // Unviewed only filter
                if (unviewedOnly && currentUser) {
                    const userViewed = viewedCandidates[currentUser] || [];
                    if (userViewed.includes(candidate.id)) {
                        return false;
                    }
                }

                return true;
            });

            displaySearchResults(filteredCandidates);
        }

        // Display search results
        function displaySearchResults(candidates) {
            const resultsContainer = document.getElementById('searchResults');
            const resultsBody = document.getElementById('searchResultsBody');
            
            resultsContainer.classList.remove('hidden');
            resultsBody.innerHTML = '';

            if (candidates.length === 0) {
                resultsBody.innerHTML = '<tr><td colspan="8" class="px-4 py-8 text-center text-gray-500">No candidates found matching your criteria</td></tr>';
                return;
            }

            candidates.forEach(candidate => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-4 whitespace-nowrap">
                        <input type="checkbox" class="candidate-checkbox" data-candidate-id="${candidate.id}">
                    </td>
                    <td class="px-4 py-4 whitespace-nowrap">
                        <div class="font-medium">${candidate.name}</div>
                    </td>
                    <td class="px-4 py-4 whitespace-nowrap">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">
                            ${candidate.status}
                        </span>
                    </td>
                    <td class="px-4 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            ${candidate.isHotCompany ? '<div class="w-2 h-2 bg-red-500 rounded-full mr-2"></div>' : ''}
                            ${candidate.company}
                        </div>
                    </td>
                    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${candidate.title}</td>
                    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${candidate.experience}</td>
                    <td class="px-4 py-4 whitespace-nowrap">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs">
                            ${candidate.score}
                        </span>
                    </td>
                    <td class="px-4 py-4 whitespace-nowrap text-sm font-medium">
                        <button class="text-blue-600 hover:text-blue-900 view-candidate" data-candidate-id="${candidate.id}">
                            View Profile
                        </button>
                    </td>
                `;
                resultsBody.appendChild(row);
            });

            // Add event listeners for checkboxes and view buttons
            document.querySelectorAll('.candidate-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const candidateId = parseInt(this.dataset.candidateId);
                    if (this.checked) {
                        addToSelected(candidateId);
                    } else {
                        removeFromSelected(candidateId);
                    }
                });
            });

            document.querySelectorAll('.view-candidate').forEach(button => {
                button.addEventListener('click', function() {
                    const candidateId = parseInt(this.dataset.candidateId);
                    viewCandidate(candidateId);
                });
            });
        }

        // Add candidate to selected list
        function addToSelected(candidateId) {
            const candidate = allCandidates.find(c => c.id === candidateId);
            if (candidate && !selectedCandidates.find(c => c.id === candidateId)) {
                selectedCandidates.push(candidate);
                updateSelectedCount();
                updateSelectedSidebar();
            }
        }

        // Remove candidate from selected list
        function removeFromSelected(candidateId) {
            selectedCandidates = selectedCandidates.filter(c => c.id !== candidateId);
            updateSelectedCount();
            updateSelectedSidebar();
        }

        // View candidate profile
        function viewCandidate(candidateId) {
            if (currentUser && currentUser !== 'guest') {
                if (!viewedCandidates[currentUser]) {
                    viewedCandidates[currentUser] = [];
                }
                if (!viewedCandidates[currentUser].includes(candidateId)) {
                    viewedCandidates[currentUser].push(candidateId);
                }
            }
            
            const candidate = allCandidates.find(c => c.id === candidateId);
            if (candidate) {
                showToast(`Viewing profile: ${candidate.name}`, 'info');
                // Here you would typically open a detailed view or modal
            }
        }

        // Update selected candidates count
        function updateSelectedCount() {
            document.getElementById('selectedCount').textContent = `Selected (${selectedCandidates.length})`;
        }

        // Toggle selected candidates sidebar
        function toggleSelectedSidebar() {
            const sidebar = document.getElementById('selectedCandidatesSidebar');
            sidebar.classList.toggle('translate-x-full');
            updateSelectedSidebar();
        }

        // Update selected candidates sidebar
        function updateSelectedSidebar() {
            const list = document.getElementById('selectedCandidatesList');
            
            if (selectedCandidates.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-users text-4xl mb-4 opacity-50"></i>
                        <p>No candidates selected</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = selectedCandidates.map(candidate => `
                <div class="border border-gray-200 rounded-lg p-3 mb-3">
                    <div class="flex justify-between items-start">
                        <div>
                            <div class="font-medium">${candidate.name}</div>
                            <div class="text-sm text-gray-500">${candidate.company}</div>
                            <div class="text-sm text-gray-500">${candidate.title}</div>
                        </div>
                        <button class="text-red-500 hover:text-red-700 text-sm" onclick="removeFromSelected(${candidate.id})">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Export selected candidates as CSV
        function exportSelectedCSV() {
            if (selectedCandidates.length === 0) {
                showToast('No candidates selected to export', 'error');
                return;
            }

            const headers = ['Name', 'Company', 'Title', 'Experience', 'Skills', 'LinkedIn', 'Status', 'Score'];
            const csvContent = [
                headers.join(','),
                ...selectedCandidates.map(candidate => [
                    candidate.name,
                    candidate.company,
                    candidate.title,
                    candidate.experience,
                    candidate.skills.join('; '),
                    candidate.linkedin,
                    candidate.status,
                    candidate.score
                ].join(','))
            ].join('\n');

            downloadCSV(csvContent, 'selected_candidates.csv');
            showToast(`Exported ${selectedCandidates.length} candidates to CSV`, 'success');
        }

        // Export LinkedIn URLs
        function exportLinkedInURLs() {
            if (selectedCandidates.length === 0) {
                showToast('No candidates selected to export', 'error');
                return;
            }

            const linkedinUrls = selectedCandidates
                .filter(candidate => candidate.linkedin)
                .map(candidate => candidate.linkedin)
                .join('\n');

            downloadTextFile(linkedinUrls, 'linkedin_urls.txt');
            showToast(`Exported ${selectedCandidates.length} LinkedIn URLs`, 'success');
        }

        // Clear selected candidates
        function clearSelectedCandidates() {
            selectedCandidates = [];
            updateSelectedCount();
            updateSelectedSidebar();
            
            // Uncheck all checkboxes
            document.querySelectorAll('.candidate-checkbox').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            showToast('Cleared selected candidates', 'info');
        }

        // Handle file upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    if (file.name.endsWith('.json')) {
                        scorelyData = JSON.parse(e.target.result);
                    } else if (file.name.endsWith('.csv')) {
                        scorelyData = parseCSV(e.target.result);
                    }
                    
                    showToast(`Uploaded ${scorelyData.length} candidate profiles from Scorely`, 'success');
                } catch (error) {
                    showToast('Error parsing file: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
        }

        // Parse CSV content
        function parseCSV(csvContent) {
            const lines = csvContent.split('\n');
            const headers = lines[0].split(',');
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = lines[i].split(',');
                    const row = {};
                    headers.forEach((header, index) => {
                        row[header.trim()] = values[index]?.trim();
                    });
                    data.push(row);
                }
            }
            
            return data;
        }

        // Reset search
        function resetSearch() {
            document.getElementById('jobTitle').value = '';
            document.getElementById('skills').value = '';
            document.getElementById('experience').value = '';
            document.getElementById('location').value = '';
            document.getElementById('companyFilter').value = '';
            document.getElementById('scoreRange').value = '';
            document.getElementById('lookingOnly').checked = false;
            document.getElementById('hotCompaniesOnly').checked = false;
            document.getElementById('unviewedOnly').checked = false;
            
            document.getElementById('searchResults').classList.add('hidden');
        }

        // Reset settings
        function resetSettings() {
            document.getElementById('googleApiKey').value = '';
            document.getElementById('openaiApiKey').value = '';
            document.getElementById('openaiModel').value = 'text-embedding-3-small';
            document.getElementById('similarityThreshold').value = '50';
            document.getElementById('thresholdValue').textContent = '50%';
            document.getElementById('autoSaveSettings').checked = false;
            document.getElementById('cacheEmbeddings').checked = true;
            
            // Clear status messages
            document.getElementById('googleConnectionStatus').classList.add('hidden');
            document.getElementById('openaiConnectionStatus').classList.add('hidden');
            
            // Clear localStorage
            localStorage.removeItem('toplySettings');
            settings = {
                googleApiKey: '',
                openaiApiKey: '',
                openaiModel: 'text-embedding-3-small',
                similarityThreshold: 50,
                autoSaveSettings: false,
                cacheEmbeddings: true
            };
            
            showToast('Settings reset to defaults', 'info');
        }

        // Download CSV file
        function downloadCSV(content, filename) {
            const blob = new Blob([content], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
        }

        // Download text file
        function downloadTextFile(content, filename) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const icon = document.getElementById('toastIcon');
            const messageEl = document.getElementById('toastMessage');
            
            // Set icon and color based on type
            let iconHtml, bgColor;
            switch(type) {
                case 'success':
                    iconHtml = '<i class="fas fa-check-circle text-green-500"></i>';
                    break;
                case 'error':
                    iconHtml = '<i class="fas fa-exclamation-circle text-red-500"></i>';
                    break;
                case 'warning':
                    iconHtml = '<i class="fas fa-exclamation-triangle text-yellow-500"></i>';
                    break;
                default:
                    iconHtml = '<i class="fas fa-info-circle text-blue-500"></i>';
            }
            
            icon.innerHTML = iconHtml;
            messageEl.textContent = message;
            
            toast.classList.remove('hidden');
            
            // Auto hide after 3 seconds
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDh5y40PLB0KkFEyYWQR8jqH5KTlHttHYxcuo19DeY%2FhJ3sx1Fuh3MUj3K1VjahvImSbYye5MCUom19kaCHdjy2KZmV1Lrw3PaVnIkALNTqIQOMTgXbRnw2yWtvZjR50NuuNoUPnpR2uwu1XWMzoh79Q92gmzX6cuiW2hPtiQ50MWWMNJ%2B7Qe8AJKyxt9WJJl1wFy400LusBAaOq3yj7PLqJR%2FkZlZThc7sdpxFXaGiSXF0fURWDI9kiQQnBLLIahLaUnFGHeRyWk8FWjiPqHaWtfa6KiE0S2aVSbAZIGaYjmdyMbusfVa%2FP8aF5ILXjjEBhNuyTzLMNL9%2BUjccq%2FpPUUrcq2XT%2BhBj%2BZShgwnnxajcOmswKNAXAWfdgkhKAaJmtNiuhhHbTVuq3wQwTN3Bhb0J610CiwyxS3tbNtovws6wmMBN%2BALhfl9G3ltCmNDhq4%2FHnP05JdC%2FMv%2BmEYsoTg%2FrR7ZMqqjPsBEvKnOa3qW3%2BvE9PRKDcfjMGCb99quw%3D%3D";
        window.__genspark_locale = "en-US";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDh5y40PLB0KkFEyYWQR8jqH5KTlHttHYxcuo19DeY/hJ3sx1Fuh3MUj3K1VjahvImSbYye5MCUom19kaCHdjy2KZmV1Lrw3PaVnIkALNTqIQOMTgXbRnw2yWtvZjR50NuuNoUPnpR2uwu1XWMzoh79Q92gmzX6cuiW2hPtiQ50MWWMNJ+7Qe8AJKyxt9WJJl1wFy400LusBAaOq3yj7PLqJR/kZlZThc7sdpxFXaGiSXF0fURWDI9kiQQnBLLIahLaUnFGHeRyWk8FWjiPqHaWtfa6KiE0S2aVSbAZIGaYjmdyMbusfVa/P8aF5ILXjjEBhNuyTzLMNL9+Ujccq/pPUUrcq2XT+hBj+ZShgwnnxajcOmswKNAXAWfdgkhKAaJmtNiuhhHbTVuq3wQwTN3Bhb0J610CiwyxS3tbNtovws6wmMBN+ALhfl9G3ltCmNDhq4/HnP05JdC/Mv+mEYsoTg/rR7ZMqqjPsBEvKnOa3qW3+vE9PRKDcfjMGCb99quw==";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
